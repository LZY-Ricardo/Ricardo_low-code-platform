# 任务清单：添加登录注册界面与路由系统

## 1. 项目准备和依赖安装
- [ ] 1.1 安装依赖包
  - [ ] 1.1.1 安装 `react-router-dom`（v6）
  - [ ] 1.1.2 安装 `axios`
  - [ ] 1.1.3 安装类型定义 `@types/node`（如需要）
- [ ] 1.2 环境配置
  - [ ] 1.2.1 创建 `.env` 文件，配置 `VITE_API_BASE_URL`
  - [ ] 1.2.2 配置 TypeScript 路径别名（可选）
- [ ] 1.3 目录结构创建
  - [ ] 1.3.1 创建 `src/pages/` 目录
  - [ ] 1.3.2 创建 `src/api/` 目录
  - [ ] 1.3.3 创建 `src/router/` 目录
  - [ ] 1.3.4 创建 `src/stores/` 目录（如不存在）
  - [ ] 1.3.5 创建 `src/components/` 目录（如不存在）
  - [ ] 1.3.6 创建 `src/types/` 目录

## 2. 类型定义
- [ ] 2.1 定义 API 相关类型
  - [ ] 2.1.1 创建 `src/types/api.ts`
  - [ ] 2.1.2 定义 User 类型（id, username, email, createdAt）
  - [ ] 2.1.3 定义 LoginRequest、LoginResponse 类型
  - [ ] 2.1.4 定义 RegisterRequest、RegisterResponse 类型
  - [ ] 2.1.5 定义 ApiError 类型
- [ ] 2.2 定义 Store 类型
  - [ ] 2.2.1 定义 AuthState 接口（user, token, isAuthenticated）

## 3. API 客户端封装
- [ ] 3.1 创建 HTTP 客户端
  - [ ] 3.1.1 创建 `src/api/client.ts`
  - [ ] 3.1.2 配置 axios 实例（baseURL, timeout）
  - [ ] 3.1.3 实现请求拦截器（自动添加 Authorization header）
  - [ ] 3.1.4 实现响应拦截器（处理 401 跳转登录）
  - [ ] 3.1.5 实现错误处理函数
- [ ] 3.2 实现认证 API
  - [ ] 3.2.1 创建 `src/api/auth.ts`
  - [ ] 3.2.2 实现 `login(username, password)` 接口
  - [ ] 3.2.3 实现 `register(userData)` 接口
  - [ ] 3.2.4 实现 `getCurrentUser()` 接口（获取当前用户信息）

## 4. 认证状态管理
- [ ] 4.1 创建 authStore
  - [ ] 4.1.1 创建 `src/stores/auth.ts`
  - [ ] 4.1.2 定义 AuthState 状态结构
  - [ ] 4.1.3 实现 `login` 方法（调用 API + 存储 token）
  - [ ] 4.1.4 实现 `register` 方法
  - [ ] 4.1.5 实现 `logout` 方法（清除 token + 重置状态）
  - [ ] 4.1.6 实现 `checkAuth` 方法（页面加载时验证 token）
  - [ ] 4.1.7 实现 token 持久化到 LocalStorage
  - [ ] 4.1.8 实现从 LocalStorage 恢复登录状态

## 5. 路由系统搭建
- [ ] 5.1 路由配置
  - [ ] 5.1.1 创建 `src/router/index.tsx`
  - [ ] 5.1.2 定义路由表（login, register, projects, editor）
  - [ ] 5.1.3 配置根路径重定向（/ → /projects）
- [ ] 5.2 路由守卫
  - [ ] 5.2.1 创建 `src/router/ProtectedRoute.tsx`
  - [ ] 5.2.2 实现未登录跳转到 /login
  - [ ] 5.2.3 实现已登录访问 login/register 自动跳转 /projects
- [ ] 5.3 集成到应用
  - [ ] 5.3.1 修改 `src/main.tsx`，包裹 `<BrowserRouter>`
  - [ ] 5.3.2 修改 `src/App.tsx`，使用 `<Routes>` 和 `<Route>`

## 6. 页面开发
- [ ] 6.1 登录页面
  - [ ] 6.1.1 创建 `src/pages/Login.tsx`
  - [ ] 6.1.2 使用 Ant Design Form 组件
  - [ ] 6.1.3 实现表单字段（用户名、密码）
  - [ ] 6.1.4 实现表单验证（必填、格式校验）
  - [ ] 6.1.5 实现登录逻辑（调用 authStore.login）
  - [ ] 6.1.6 实现错误提示（message 组件）
  - [ ] 6.1.7 添加"前往注册"链接
  - [ ] 6.1.8 页面样式美化（居中卡片布局）
- [ ] 6.2 注册页面
  - [ ] 6.2.1 创建 `src/pages/Register.tsx`
  - [ ] 6.2.2 实现表单字段（用户名、邮箱、密码、确认密码）
  - [ ] 6.2.3 实现表单验证规则
    - [ ] 用户名：4-20 字符
    - [ ] 邮箱：标准邮箱格式
    - [ ] 密码：8-20 字符，字母+数字
    - [ ] 确认密码：与密码一致
  - [ ] 6.2.4 实现注册逻辑（调用 authStore.register）
  - [ ] 6.2.5 注册成功自动跳转登录页
  - [ ] 6.2.6 添加"已有账号？去登录"链接
  - [ ] 6.2.7 页面样式美化
- [ ] 6.3 项目列表页
  - [ ] 6.3.1 创建 `src/pages/Projects.tsx`
  - [ ] 6.3.2 从 projectStore 获取项目列表
  - [ ] 6.3.3 使用卡片网格布局展示项目
  - [ ] 6.3.4 实现"新建项目"按钮
  - [ ] 6.3.5 实现项目卡片（名称、更新时间）
  - [ ] 6.3.6 实现项目操作（打开编辑器、删除、重命名）
  - [ ] 6.3.7 实现空状态提示（无项目时）
- [ ] 6.4 布局组件
  - [ ] 6.4.1 创建 `src/components/Layout.tsx`
  - [ ] 6.4.2 实现顶部导航栏
  - [ ] 6.4.3 显示用户信息（头像 + 用户名）
  - [ ] 6.4.4 实现下拉菜单（退出登录）
  - [ ] 6.4.5 集成到受保护的路由页面

## 7. 编辑器页面改造
- [ ] 7.1 路由集成
  - [ ] 7.1.1 将 `src/editor/index.tsx` 改为路由页面
  - [ ] 7.1.2 使用 `useParams` 获取 projectId
  - [ ] 7.1.3 根据 projectId 加载项目数据
  - [ ] 7.1.4 添加返回项目列表按钮

## 8. 测试与验证
- [ ] 8.1 功能测试
  - [ ] 8.1.1 测试用户注册流程
  - [ ] 8.1.2 测试用户登录流程
  - [ ] 8.1.3 测试路由跳转（login → projects → editor）
  - [ ] 8.1.4 测试路由守卫（未登录拦截）
  - [ ] 8.1.5 测试退出登录
  - [ ] 8.1.6 测试 token 过期处理（401 跳转）
  - [ ] 8.1.7 测试表单验证（错误输入）
- [ ] 8.2 用户体验测试
  - [ ] 8.2.1 测试加载状态（loading spinner）
  - [ ] 8.2.2 测试错误提示（网络错误、账号不存在等）
  - [ ] 8.2.3 测试页面刷新后状态保持
- [ ] 8.3 边界情况测试
  - [ ] 8.3.1 测试 API 请求失败
  - [ ] 8.3.2 测试网络断开
  - [ ] 8.3.3 测试重复登录
  - [ ] 8.3.4 测试浏览器前进/后退

## 9. 优化与完善
- [ ] 9.1 性能优化
  - [ ] 9.1.1 添加路由懒加载（React.lazy）
  - [ ] 9.1.2 优化组件重渲染
- [ ] 9.2 用户体验优化
  - [ ] 9.2.1 添加页面过渡动画
  - [ ] 9.2.2 优化表单交互（Enter 提交）
  - [ ] 9.2.3 记住上次登录的用户名（可选）
- [ ] 9.3 代码质量
  - [ ] 9.3.1 代码格式化（Prettier）
  - [ ] 9.3.2 类型检查（TypeScript）
  - [ ] 9.3.3 添加必要的注释

## 10. 文档更新
- [ ] 10.1 更新项目文档
  - [ ] 10.1.1 更新 README（启动说明、环境变量）
  - [ ] 10.1.2 更新技术栈说明（添加 React Router、Axios）
- [ ] 10.2 API 文档
  - [ ] 10.2.1 记录前端 API 调用接口
